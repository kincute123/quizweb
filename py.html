<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trang chủ</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
      }
      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-bottom: 20px;
        border-bottom: 2px solid #f0f0f0;
        margin-bottom: 30px;
      }
      .user-info {
        display: flex;
        align-items: center;
        gap: 15px;
      }
      .avatar {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        font-weight: bold;
      }
      .user-details h2 {
        font-size: 24px;
        color: #333;
        margin-bottom: 5px;
      }
      .user-details p {
        color: #666;
        font-size: 14px;
        margin-bottom: 14px;
      }
      .logout-btn {
        padding: 10px 25px;
        background: #dc3545;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        transition: all 0.3s;
      }
      .logout-btn:hover {
        background: #c82333;
        transform: translateY(-2px);
      }
      .welcome-section {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 40px;
        border-radius: 12px;
        text-align: center;
        margin-bottom: 30px;
      }
      .welcome-section h1 {
        font-size: 36px;
        margin-bottom: 10px;
      }
      .welcome-section p {
        font-size: 18px;
        opacity: 0.9;
      }
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }
      .stat-card {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 12px;
        border-left: 4px solid #667eea;
      }
      .stat-card h3 {
        color: #666;
        font-size: 14px;
        margin-bottom: 10px;
        text-transform: uppercase;
      }
      .stat-card .value {
        font-size: 32px;
        font-weight: bold;
        color: #333;
      }
      .content-section {
        margin-top: 30px;
      }
      .content-section h2 {
        font-size: 24px;
        color: #333;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid #f0f0f0;
      }
      .placeholder {
        background: #f8f9fa;
        border: 2px dashed #ddd;
        border-radius: 12px;
        padding: 60px;
        text-align: left;
        color: #999;
        font-size: 50px;
      }

      .img-py {
        border-radius: 20px;
      }
      .back-dash {
        padding: 10px 25px;
        background: #43d650;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        transition: all 0.3s;
      }
      .back-dash:hover {
        background: #32642a;
        transform: perspective(0.5px) translateY(-20%);
      }
      .submit {
        width: 100%;
        max-width: 320px;
        margin: 30px auto 0;
        display: block;

        padding: 16px 48px;
        font-size: 18px;
        font-weight: 600;
        letter-spacing: 0.5px;

        color: #fff;
        background: linear-gradient(135deg, #6a5af9, #9b5cff);
        border: none;
        border-radius: 999px;

        cursor: pointer;
        box-shadow: 0 10px 25px rgba(106, 90, 249, 0.4);
        transition: all 0.3s ease;
      }
      .submit:hover {
        transform: translateY(-3px);
        box-shadow: 0 14px 30px rgba(106, 90, 249, 0.55);
      }
      .submit:active {
        transform: scale(0.96);
        box-shadow: 0 6px 15px rgba(106, 90, 249, 0.35);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header với thông tin user -->
      <header>
        <div class="user-info">
          <div class="avatar" id="avatar"></div>
          <div class="user-details">
            <h2 id="username">Loading...</h2>
            <p>Đăng nhập lúc: <span id="loginTime"></span></p>
            <button class="back-dash" onclick="backdash()">Trang chủ</button>
            <span class="info-badge" id="similarity"></span>
          </div>
        </div>
        <button class="logout-btn" onclick="logout()">Đăng xuất</button>
      </header>

      <!-- Welcome Section -->
      <div class="welcome-section">
        <h1>Chào mừng đến với khóa học học python</h1>
        <p>Nơi chúng ta sục cùng code</p>
      </div>

      <!-- Stats Grid -->
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Thời gian online</h3>
          <div class="value" id="onlineTime">0 phút</div>
        </div>
        <div class="stat-card">
          <h3>Trạng thái</h3>
          <div class="value" style="color: #28a745; font-size: 24px">
            Đã xác thực
          </div>
        </div>
      </div>
      <div class="content-section">
        <h2>Nội dung của bài học python</h2>
        <div class="placeholder">
          <p style="margin-top: 10px; font-size: 30px"></p>
          <h3>Câu 1: Phương thức để thêm phần tử vào danh sách là gì?</h3>
          <label><input type="radio" name="q1" value="A" /> A. add()</label
          ><br />
          <label><input type="radio" name="q1" value="B" /> B. append()</label
          ><br />
          <label><input type="radio" name="q1" value="C" /> C. insert()</label
          ><br />
          <label><input type="radio" name="q1" value="D" /> D. push()</label>

          <br /><br />

          <h3>
            Câu 2: Kiểu dữ liệu nào sau đây không phải kiểu dữ liệu cơ bản trong
            Python?
          </h3>
          <label><input type="radio" name="q2" value="A" /> A. int</label><br />
          <label><input type="radio" name="q2" value="B" /> B. float</label
          ><br />
          <label><input type="radio" name="q2" value="C" /> C. char</label
          ><br />
          <label><input type="radio" name="q2" value="D" /> D. push()</label>


          <br /><br />

          <h3></h3>
            Câu 3: Từ khóa nào dùng để thoát khỏi vòng lặp?
          </h3>
          <br>
          <label><input type="radio" name="q3" value="A" /> A. exit</label><br />
          <label><input type="radio" name="q3" value="B" /> B. stop</label><br />
          <label><input type="radio" name="q3" value="C" /> C. break</label><br />
          <label><input type="radio" name="q3" value="D" /> D. return</label>

          <br /><br />

          <h3>
            Câu 4: Từ khóa nào dùng để định nghĩa hàm?
          </h3>
          <label><input type="radio" name="q4" value="A" /> A. function</label><br />
          <label><input type="radio" name="q4" value="B" /> B. def</label><br />
          <label><input type="radio" name="q4" value="C" /> C. func</label><br />
          <label><input type="radio" name="q4" value="D" /> D. define</label>

          <br /><br />

          <h3>
            Câu 5: Phương thức nào dùng để lấy độ dài của một chuỗi?
          </h3>
          <label><input type="radio" name="q5" value="A" /> A. length()</label
          ><br />
          <label><input type="radio" name="q5" value="B" /> B. size()</label
          ><br />
          <label><input type="radio" name="q5" value="C" /> C. len()</label
          ><br />
          <label><input type="radio" name="q5" value="" /> D. count()</label>

        </div>
      </div>
    </div>
    <script>
      // Kiểm tra đã đăng nhập chưa
      function checkAuth() {
        const username = localStorage.getItem("username");
        if (!username) {
          // Chưa đăng nhập -> quay về trang login
          window.location.href = "index.html";
          return false;
        }
        return true;
      }

      // Load thông tin user
      function loadUserInfo() {
        const username = localStorage.getItem("username");
        const loginTime = localStorage.getItem("loginTime");
        const similarity = localStorage.getItem("similarity");

        // Hiển thị tên
        document.getElementById("username").textContent = username;

        // Avatar chữ cái đầu
        document.getElementById("avatar").textContent = username
          .charAt(0)
          .toUpperCase();

        // Thời gian đăng nhập
        const time = new Date(loginTime);
        document.getElementById("loginTime").textContent =
          time.toLocaleString("vi-VN");

        // Cập nhật thời gian online mỗi phút
        updateOnlineTime();
        setInterval(updateOnlineTime, 60000);
      }

      // Cập nhật thời gian online
      function updateOnlineTime() {
        const loginTime = new Date(localStorage.getItem("loginTime"));
        const now = new Date();
        const minutes = Math.floor((now - loginTime) / 1000 / 60);

        if (minutes < 60) {
          document.getElementById("onlineTime").textContent = `${minutes} phút`;
        } else {
          const hours = Math.floor(minutes / 60);
          const mins = minutes % 60;
          document.getElementById(
            "onlineTime"
          ).textContent = `${hours}h ${mins}m`;
        }
      }
      //trở về trang chủ
      function backdash() {
        window.location.href = "index.html";
      }

      // Đăng xuất
      function logout() {
        if (confirm("Bạn có chắc muốn đăng xuất?")) {
          localStorage.removeItem("username");
          localStorage.removeItem("loginTime");
          localStorage.removeItem("similarity");
          window.location.href = "FE.html";
        }
      }
      // Khởi động
      if (checkAuth()) {
        loadUserInfo();
      }
    </script>
    <div class="submit">
      <button id="submitBtn" onclick="submitQuiz()">Nộp bài</button>
    </div>
    <p id="result"></p>

    <script>
      function submitQuiz() {
        const answers = {
          1: document.querySelector('input[name="q1"]:checked')?.value,
          2: document.querySelector('input[name="q2"]:checked')?.value,
        };

        fetch("http://127.0.0.1:8000/submit-quiz", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            user_id: "user_001",
            answers: answers,
          }),
        })
          .then((res) => res.json())
          .then((data) => {
            document.getElementById(
              "result"
            ).innerText = `  Bạn đúng ${data.score}/${data.total} câu`;
          });
      }
    </script>
  </body>
</html>
